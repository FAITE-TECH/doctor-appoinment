<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />

    <link rel="stylesheet" href="../public/css/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="../public/assets/logo.png" />

    <title>HPC Hospital</title>
  </head>
  <body>
    <div id="header"></div>
    <script>
      fetch("shared-nav.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("header").innerHTML = data;
          // Initialize navigation after it's loaded
          if (window.initNavigationAfterLoad) {
            window.initNavigationAfterLoad();
          }
        });
    </script>
    <!-- Hero Image -->
    <div
      class="relative md:w-full md:h-[600px] h-[400px] mb-6 shadow-lg rounded-2xl flex justify-center align-center"
    >
      <!-- Image -->
      <img
        id="slider-image"
        class="w-full h-full object-cover transition duration-500"
        src="../public/assets/doctor1.jpg"
        alt="Hero Image"
      />

      <!-- Left Arrow -->
      <button
        id="prev"
        class="absolute top-1/2 left-3 -translate-y-1/2 bg-black bg-opacity-40 text-white p-3 rounded-full hover:bg-opacity-70 transition"
      >
        &#10094;
      </button>

      <!-- Right Arrow -->
      <button
        id="next"
        class="absolute top-1/2 right-3 -translate-y-1/2 bg-black bg-opacity-40 text-white p-3 rounded-full hover:bg-opacity-70 transition"
      >
        &#10095;
      </button>

      <!-- Dots -->
      <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
        <span
          class="dot w-3 h-3 bg-white rounded-full cursor-pointer opacity-70"
        ></span>
        <span
          class="dot w-3 h-3 bg-white rounded-full cursor-pointer opacity-70"
        ></span>
        <span
          class="dot w-3 h-3 bg-white rounded-full cursor-pointer opacity-70"
        ></span>
      </div>
    </div>

    <script>
      const images = [
        "../public/assets/hero1.jpg",
        "../public/assets/hero2.jpg",
        "../public/assets/hero3.jpg",
      ];

      let index = 0;
      const sliderImage = document.getElementById("slider-image");
      const prevBtn = document.getElementById("prev");
      const nextBtn = document.getElementById("next");
      const dots = document.querySelectorAll(".dot");

      function showImage(i) {
        index = (i + images.length) % images.length;
        sliderImage.src = images[index];

        // Update dots
        dots.forEach((dot, idx) => {
          dot.classList.toggle("bg-blue-500", idx === index);
          dot.classList.toggle("opacity-70", idx !== index);
        });
      }

      prevBtn.addEventListener("click", () => {
        showImage(index - 1);
      });

      nextBtn.addEventListener("click", () => {
        showImage(index + 1);
      });

      dots.forEach((dot, idx) => {
        dot.addEventListener("click", () => showImage(idx));
      });

      // Initialize
      showImage(index);
    </script>

    <!-- Form Section -->
    <div class="flex flex-col lg:flex-row gap-8 px-6 py-10 max-w-6xl mx-auto">
      <!-- Check Schedule -->
      <div class="flex-1 p-6 bg-blue-500 rounded-lg" id="appointment-form">
        <h1 class="text-xl font-bold text-white mb-4">Check Schedule</h1>
        <div class="w-20 h-0.5 bg-red-400 mb-6"></div>

        <div class="flex flex-col gap-4">
          <div class="flex flex-col">
            <label class="text-sm font-medium text-white mb-1"
              >Department</label
            >
            <select
              id="specialFilter"
              class="border h-12 px-3 py-2 focus:ring-2 focus:ring-blue-400 rounded-md"
            >
              <option value="">Select one</option>
            </select>
          </div>

          <!-- Filtered Doctors -->
          <div id="doctorCtn" class="my-6"></div>
        </div>
      </div>

      <!-- Book Appointment -->
      <div class="flex-1 bg-blue-500 rounded-lg px-6 py-8">
        <h1 class="text-xl font-bold text-white mb-4">Book Appointment</h1>
        <div class="w-24 h-0.5 bg-red-400 mb-6"></div>

        <form class="flex flex-col gap-6">
          <!-- Patient Info -->
          <div class="flex flex-col sm:flex-row gap-4">
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1"
                >Patient Name</label
              >
              <input
                type="text"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              />
            </div>
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1"
                >Phone No</label
              >
              <input
                type="text"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              />
            </div>
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1">Email</label>
              <input
                type="email"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              />
            </div>
          </div>

          <!-- Department & Doctor -->
          <div class="flex flex-col sm:flex-row gap-4">
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1"
                >Department</label
              >
              <select
                id="deptSelect"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              >
                <option value="">Select one</option>
              </select>
            </div>
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1">Doctor</label>
              <select
                id="doctorSelect"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              >
                <option value="">Select one</option>
              </select>
            </div>
          </div>

          <!-- Date & Time -->
          <div class="flex flex-col sm:flex-row gap-4">
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1"
                >Choose Date</label
              >
              <input
                id="datePicker"
                type="text"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              />
            </div>
            <div class="flex-1 flex flex-col">
              <label class="text-sm font-medium text-white mb-1"
                >Choose Time</label
              >
              <input
                id="timePicker"
                type="text"
                class="border h-12 px-3 py-2 focus:ring-2 focus:ring-green-400 rounded-md"
                required
              />
            </div>
          </div>
          <!-- Flatpickr JS -->
          <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
          <script>
            // Initialize Date Picker
            flatpickr("#datePicker", {
              dateFormat: "Y-m-d",
              minDate: "today", // Disable past dates
            });

            // Initialize Time Picker
            flatpickr("#timePicker", {
              enableTime: true,
              noCalendar: true,
              dateFormat: "H:i",
              time_24hr: true, // 24-hour format, set false for AM/PM
            });
          </script>
          <!-- Toast Notification -->
          <div
            id="toast"
            class="hidden fixed top-5 right-5 bg-black text-white px-4 py-3 rounded-lg shadow-lg transition-opacity duration-500 z-[9999]"
          >
            ✅ Booking successful!
          </div>

          <button
            type="submit"
            onclick="showToast()"
            class="bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition w-full sm:w-auto"
          >
            Book Now
          </button>
        </form>

        <p class="p-5 text-white text-sm sm:text-base">
          Please fill out all of the fields correctly. Your records will be
          saved in our database securely.
        </p>
      </div>
    </div>

    <!-- filter for doctors dropdown -->
    <script>
      const doctorCtn = document.getElementById("doctorCtn");
      const specialFilter = document.getElementById("specialFilter");

      // Render doctors dynamically for appointment form
      function renderFilteredDoctors(list) {
        doctorCtn.innerHTML = ""; // clear old data
        if (list.length === 0) {
          doctorCtn.innerHTML = `<p class="text-white">No doctors found</p>`;
          return;
        }

        list.forEach((doctor) => {
          const doctorCard = document.createElement("div");
          doctorCard.className =
            "bg-white border my-7 rounded-lg shadow p-6 flex flex-col md:flex-row items-center gap-4 transition hover:shadow-lg ";

          // Use the image from database or fallback to default
          const doctorImage = doctor.image_path || "../public/assets/doctor1.jpg";
          const doctorSpecialization = doctor.specialization || doctor.department_name || "General";

          doctorCard.innerHTML = `
              <img src="${doctorImage}" alt="${doctor.name}" 
                class="w-32 h-32 md:w-10 md:h-10 rounded-full object-cover mb-3 md:mb-0">

              <div class="flex flex-col p-0 md:flex-row md:items-center md:justify-between w-full">
                <div>
                  <h3 class="text-lg font-semibold">${doctor.name}</h3>
                  <p class="text-sm text-gray-500">${doctorSpecialization}</p>
                </div>

                <a onclick="window.location.href='doctor-details.html?id=${doctor.id}'" 
                  class="mt-3 md:mt-0 bg-red-600 w-full text-white py-1 px-2 rounded-md hover:bg-red-700 cursor-pointer transition"
                >
                  View Schedule
                </a>
              </div>
            `;
          doctorCtn.appendChild(doctorCard);
        });
      }

      // Only filter when selection changes (no default rendering)
      specialFilter.addEventListener("change", (e) => {
        const selected = e.target.value;
        if (selected === "") {
          doctorCtn.innerHTML = `<p class="text-gray-500">Please select a specialization</p>`;
        } else {
          const filtered = doctors.filter((doc) => 
            (doc.specialization && doc.specialization.toLowerCase().includes(selected.toLowerCase())) ||
            (doc.department_name && doc.department_name.toLowerCase().includes(selected.toLowerCase()))
          );
          renderFilteredDoctors(filtered);
        }
      });

      // Update the global doctors variable when fetched
      window.updateDoctorsForFilter = function(doctorsData) {
        doctors = doctorsData;
      };

      // Populate doctor dropdown when department is selected
      document.addEventListener('DOMContentLoaded', function() {
        const deptSelect = document.getElementById('deptSelect');
        const doctorSelect = document.getElementById('doctorSelect');

        if (deptSelect && doctorSelect) {
          deptSelect.addEventListener('change', function() {
            const selectedDept = this.value;
            
            // Clear doctor dropdown
            doctorSelect.innerHTML = '<option value="">Select one</option>';
            
            if (selectedDept) {
              // Filter doctors by selected department
              const filteredDoctors = doctors.filter(doctor => 
                (doctor.specialization && doctor.specialization.toLowerCase().includes(selectedDept.toLowerCase())) ||
                (doctor.department_name && doctor.department_name.toLowerCase().includes(selectedDept.toLowerCase()))
              );

              // Add filtered doctors to dropdown
              filteredDoctors.forEach(doctor => {
                const option = document.createElement('option');
                option.value = doctor.id;
                option.textContent = doctor.name;
                doctorSelect.appendChild(option);
              });
            }
          });
        }
      });
    </script>

    <script>
      function showToast() {
        const toast = document.getElementById("toast");
        toast.classList.remove("hidden");
        toast.style.opacity = "1";

        // Hide after 3 seconds
        setTimeout(() => {
          toast.style.opacity = "0";
          setTimeout(() => toast.classList.add("hidden"), 500); // wait for fade-out
        }, 1000);
      }
    </script>
    <!-- Best Hospital -->
    <div>
      <div class="text-center my-10">
        <h2 class="text-3xl text-flourish-500 font-bold">
          Best Hospitals in Town
        </h2>
        <p class="text-gray-400">When it comes to health</p>
      </div>
      <div class="max-w-6xl mx-auto px-6 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
          <!-- Feature 1 -->
          <div
            class="p-6 bg-white rounded-2xl hover:shadow-xl transition duration-300"
          >
            <i class="fa-solid fa-desktop text-red-500 text-5xl mb-4"></i>
            <h2 class="text-xl font-semibold text-gray-800 mb-2">
              Powerful Theme Options
            </h2>
            <p class="text-gray-600">
              Lorem Ipsum is simply dummy text of the printing and typesetting
              industry. Lorem Ipsum has been the industry's standard.
            </p>
          </div>

          <!-- Feature 2 -->
          <div
            class="p-6 bg-white rounded-2xl hover:shadow-xl transition duration-300"
          >
            <i class="fa-solid fa-bolt text-red-500 text-5xl mb-4"></i>
            <h2 class="text-xl font-semibold text-gray-800 mb-2">
              Fast Performance
            </h2>
            <p class="text-gray-600">
              Experience blazing fast load times and smooth interactions with
              optimized code and design.
            </p>
          </div>

          <!-- Feature 3 -->
          <div
            class="p-6 bg-white rounded-2xl hover:shadow-xl transition duration-300"
          >
            <i class="fa-solid fa-mobile-screen text-red-500 text-5xl mb-4"></i>
            <h2 class="text-xl font-semibold text-gray-800 mb-2">
              Fully Responsive
            </h2>
            <p class="text-gray-600">
              Works seamlessly across all devices, ensuring the best user
              experience no matter the screen size.
            </p>
          </div>
        </div>

        <!-- Second row -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center mt-8">
          <div
            class="p-6 bg-white rounded-2xl hover:shadow-xl transition duration-300"
          >
            <i class="fa-solid fa-lock text-red-500 text-5xl mb-4"></i>
            <h2 class="text-xl font-semibold text-gray-800 mb-2">
              Secure & Reliable
            </h2>
            <p class="text-gray-600">
              Built with top-notch security practices to keep your data safe and
              reliable at all times.
            </p>
          </div>

          <div
            class="p-6 bg-white rounded-2xl hover:shadow-xl transition duration-300"
          >
            <i
              class="fa-solid fa-wand-magic-sparkles text-red-500 text-5xl mb-4"
            ></i>
            <h2 class="text-xl font-semibold text-gray-800 mb-2">
              Easy Customization
            </h2>
            <p class="text-gray-600">
              Customize everything with simple options, no coding skills
              required to make it yours.
            </p>
          </div>

          <div
            class="p-6 bg-white rounded-2xl hover:shadow-xl transition duration-300"
          >
            <i class="fa-solid fa-headset text-red-500 text-5xl mb-4"></i>
            <h2 class="text-xl font-semibold text-gray-800 mb-2">
              24/7 Support
            </h2>
            <p class="text-gray-600">
              Get instant help from our dedicated support team, anytime you need
              assistance.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Doctors -->

    <section id="doctors" data-animate="fade-up" class="mx-auto">
      <div class="text-center my-10 container mx-auto max-w-6xl px-4">
        <h2 class="text-3xl text-flourish-500 font-bold">OUR DOCTORS</h2>
        <p class="text-gray-400 mt-2">
          Our doctors are specialized in their field and have more than 10 years
          of experiences.
        </p>
        <div class="w-40 h-0.5 bg-red-400 mt-4 mx-auto"></div>

        <!-- Doctor Cards Grid -->
        <div
          id="doctorContainer"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mt-10"
        >
          <!-- Cards will be injected by JS -->
        </div>

        <div class="mt-8">
          <a
            href="./doctors.html"
            class="text-blue-600 font-semibold hover:underline"
          >
            View All Doctors →
          </a>
        </div>
      </div>
    </section>

    <script>
      // Global variable to store doctors data
      let doctors = [];

      // Fetch doctors from API
      async function fetchDoctors() {
        try {
          const response = await fetch('/doctor-appoinment/Backend/api/doctors.php?action=doctors');
          const data = await response.json();
          
          if (data.status === 'success') {
            doctors = data.data;
            renderDoctors();
            populateDepartmentDropdowns();
            // Update the filter functionality with real data
            if (window.updateDoctorsForFilter) {
              window.updateDoctorsForFilter(doctors);
            }
          } else {
            console.error('Failed to fetch doctors:', data.message);
            // Fallback to empty state
            const doctorContainer = document.getElementById("doctorContainer");
            doctorContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No doctors available at the moment.</p>';
          }
        } catch (error) {
          console.error('Error fetching doctors:', error);
          // Fallback to empty state
          const doctorContainer = document.getElementById("doctorContainer");
          doctorContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">Unable to load doctors. Please try again later.</p>';
        }
      }

      // Populate department dropdowns based on available doctor specializations
      function populateDepartmentDropdowns() {
        const specializations = new Set();
        
        doctors.forEach(doctor => {
          if (doctor.specialization) {
            specializations.add(doctor.specialization);
          }
          if (doctor.department_name) {
            specializations.add(doctor.department_name);
          }
        });

        const specialFilter = document.getElementById("specialFilter");
        const deptSelect = document.getElementById("deptSelect");

        // Clear existing options except the first one
        [specialFilter, deptSelect].forEach(select => {
          if (select) {
            // Keep the first option (Select one)
            const firstOption = select.querySelector('option[value=""]');
            select.innerHTML = '';
            if (firstOption) {
              select.appendChild(firstOption);
            }

            // Add specialization options
            specializations.forEach(spec => {
              const option = document.createElement('option');
              option.value = spec;
              option.textContent = spec;
              select.appendChild(option);
            });
          }
        });
      }

      // Render doctors on the page
      function renderDoctors() {
        const doctorContainer = document.getElementById("doctorContainer");
        doctorContainer.innerHTML = ''; // Clear existing content

        // Show only first 4 doctors
        const doctorsToShow = doctors.slice(0, 4);

        if (doctorsToShow.length === 0) {
          doctorContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No doctors available at the moment.</p>';
          return;
        }

        doctorsToShow.forEach((doctor) => {
          const doctorCard = document.createElement("div");
          doctorCard.className =
            "bg-white border border-gray-200 overflow-hidden shadow-sm hover:shadow-lg transition flex flex-col";

          // Use the image from database or fallback to default
          const doctorImage = doctor.image_path || "../public/assets/doctor1.jpg";
          const doctorSpecialization = doctor.specialization || doctor.department_name || "General";
          const doctorDescription = doctor.description || "Experienced medical professional dedicated to providing quality healthcare services.";

          doctorCard.innerHTML = `
        <!-- Doctor Image Wrapper -->
          <div class="relative h-56 w-full overflow-hidden group">
            <!-- Main clickable image -->
            <a href="doctor-details.html?id=${doctor.id}" class="block h-full w-full">
              <img src="${doctorImage}" alt="${doctor.name}"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
            </a>

            <!-- Social Icons Overlay -->
            <div
              class="absolute inset-0 flex items-center justify-center space-x-4 
                    bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 
                    transition-opacity duration-500 ease-in-out">
              <a href="#" class="text-white text-2xl hover:text-blue-400 transform hover:scale-110 transition">
                <i class="fab fa-facebook-f"></i>
              </a>
              <a href="#" class="text-white text-2xl hover:text-blue-400 transform hover:scale-110 transition">
                <i class="fab fa-twitter"></i>
              </a>
              <a href="#" class="text-white text-2xl hover:text-blue-400 transform hover:scale-110 transition">
               <i class="fa-solid fa-phone"></i>
              </a>
              <a href="#" class="text-white text-2xl hover:text-blue-400 transform hover:scale-110 transition">
                <i class="fa-solid fa-envelope"></i>
              </a>
            </div>
          </div>

       
        <!-- Doctor Content -->
        <div class="p-6 flex flex-col justify-between flex-grow">
          <h3 class="text-xl font-sans-serif text-blue-800 mb-2 text-start">${doctor.name}</h3>
          <p class="bg-green-100 text-blue-500 text-xs font-[Roboto] px-3 py-1 rounded-full uppercase w-fit mb-3">
            ${doctorSpecialization}
          </p>
          
          <p class="text-gray-600 text-md mb-4 clamp-4 text-start">${doctorDescription}</p>

          <div class="flex justify-between items-center text-gray-400 text-sm">
            <p>10+ years experience</p>
            <button onclick="window.location.href='doctor-details.html?id=${doctor.id}'" 
              class="text-black font-sans-serif px-4 py-2 rounded-md hover:text-blue-500 transition">
              View →
            </button>
          </div>
        </div>
      `;

          doctorContainer.appendChild(doctorCard);
        });
      }

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", () => {
        fetchDoctors();
      });
    </script>

    <!-- TESTIMONIALS -->

    <section>
      <div class="text-center my-10">
        <h2 class="text-3xl text-flourish-500 font-bold section-title">
          TESTIMONIALS
        </h2>

        <div class="w-40 h-0.5 bg-red-400 mt-4 flex mx-auto"></div>
      </div>
      <div class="relative max-w-6xl mx-auto px-6 py-8 text-center">
        <!-- Testimonials -->
        <div class="testimonial hidden">
          <h2 class="text-lg font-thin text-gray-500">
            I really appreciate all your kindness and good care you have
            provided me with. Thank you so much!
          </h2>
          <img
            src="../public/assets/doctor1.jpg"
            alt="doctor"
            class="w-12 h-12 rounded-full flex mx-auto mt-4"
          />
          <p class="mt-2 font-semibold text-red-500">Martha Stewart</p>
        </div>

        <div class="testimonial hidden">
          <h2 class="text-lg font-medium font-thin text-gray-500">
            Amazing staff, they took care of me like family. Couldn’t have asked
            for better service!
          </h2>
          <img
            src="../public/assets/doctor2.jpg"
            alt="doctor"
            class="w-12 h-12 rounded-full flex mx-auto mt-4"
          />
          <p class="mt-2 font-semibold text-red-500">John Doe</p>
        </div>

        <div class="testimonial hidden">
          <h2 class="text-lg font-medium font-thin text-gray-500">
            From start to finish, I felt supported and safe. I highly recommend
            this hospital!
          </h2>
          <img
            src="../public/assets/doctor3.jpg"
            alt="doctor"
            class="w-12 h-12 rounded-full flex mx-auto mt-4"
          />
          <p class="mt-2 font-semibold text-red-500">Sarah Lee</p>
        </div>

        <!-- Dots -->
        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
          <span
            class="round w-3 h-3 bg-gray-400 rounded-full cursor-pointer"
            onclick="showTestimonial(0)"
          ></span>
          <span
            class="round w-3 h-3 bg-gray-400 rounded-full cursor-pointer"
            onclick="showTestimonial(1)"
          ></span>
          <span
            class="round w-3 h-3 bg-gray-400 rounded-full cursor-pointer"
            onclick="showTestimonial(2)"
          ></span>
        </div>
      </div>

      <script>
        let currentIndex = 0;
        const testimonials = document.querySelectorAll(".testimonial");
        const rounds = document.querySelectorAll(".round");

        function showTestimonial(index) {
          testimonials[currentIndex].classList.add("hidden");
          rounds[currentIndex].classList.remove("bg-blue-500");

          testimonials[index].classList.remove("hidden");
          rounds[index].classList.add("bg-blue-500");

          currentIndex = index;
        }

        // Show first testimonial by default
        showTestimonial(0);
      </script>
    </section>

    <!-- Our services -->

    <section>
      <div
        id="services"
        class="text-center my-10 container mx-auto w-full md:justify-center md:place-items-center px-4"
      >
        <h2 class="text-3xl text-flourish-500 font-bold">OUR SERVICES</h2>

        <div class="w-40 h-0.5 bg-red-400 mt-4 mx-auto"></div>

        <!-- Services Cards Grid -->
        <div
          id="serviceContainer"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mt-10"
        >
          <!-- Cards will be injected by JS -->
        </div>

        <div class="mt-8">
          <a
            href="./services.html"
            class="text-blue-600 font-semibold hover:underline"
          >
            View All Services →
          </a>
        </div>
      </div>
    </section>
    <script>
      // Global variable to store services data
      let services = [];

      // Fetch services from API
      async function fetchServices() {
        try {
          const response = await fetch('/doctor-appoinment/Backend/api/services.php?action=public');
          const data = await response.json();
          
          if (data.status === 'success') {
            services = data.data;
            renderServices();
          } else {
            console.error('Failed to fetch services:', data.message);
            // Fallback to empty state
            const serviceContainer = document.getElementById("serviceContainer");
            serviceContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No services available at the moment.</p>';
          }
        } catch (error) {
          console.error('Error fetching services:', error);
          // Fallback to empty state
          const serviceContainer = document.getElementById("serviceContainer");
          serviceContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">Unable to load services. Please try again later.</p>';
        }
      }

      // Render services on the page
      function renderServices() {
        const serviceContainer = document.getElementById("serviceContainer");
        serviceContainer.innerHTML = ''; // Clear existing content

        // Show only first 4 services
        const servicesToShow = services.slice(0, 4);

        if (servicesToShow.length === 0) {
          serviceContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No services available at the moment.</p>';
          return;
        }

        servicesToShow.forEach((service) => {
          const serviceCard = document.createElement("div");
          serviceCard.className =
            "bg-white border border-gray-200 overflow-hidden shadow-sm hover:shadow-lg transition flex flex-col";

          // Use the image from database or fallback to default
          const serviceImage = service.image_path ? `/doctor-appoinment/uploads/services/${service.image_path}` : "../public/assets/eyecare.jpg";
          const serviceName = service.name || "Service";
          const serviceDescription = service.description || "Quality healthcare service provided by our experienced team.";

          serviceCard.innerHTML = `
        <!-- Service Image Wrapper -->
        <a href="service-details.html?id=${service.id}">
        <div class="relative h-56 w-full overflow-hidden group">
          <img src="${serviceImage}" alt="${serviceName}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
          
        </div>
        </a>

        <!-- Service Content -->
        <div class="p-6 flex flex-col justify-between flex-grow">
          <h3 class="text-xl font-semibold text-blue-800 mb-2 text-start">${serviceName}</h3>
          

          <p class="text-gray-600 text-md mb-4 clamp-4 text-start leading-relaxed">${serviceDescription}</p>

      
        </div>
      `;

          serviceContainer.appendChild(serviceCard);
        });
      }

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", () => {
        fetchServices();
      });
    </script>

    <!-- LATEST NEWS -->

    <section>
      <div class="text-center my-10 container max-w-6xl mx-auto px-4">
        <h2 class="text-3xl text-flourish-500 font-bold">LATEST NEWS</h2>
        <p class="text-gray-400 mt-2">
          Our doctors are specialized in their field and have more than 10 years
          of experiences.
        </p>
        <div class="w-40 h-0.5 bg-red-400 mt-4 mx-auto"></div>

        <!-- Services Cards Grid -->
        <div
          id="newsContainer"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mt-10"
        >
          <!-- Cards will be injected by JS -->
        </div>

        <div class="mt-8">
          <a
            href="./services.html"
            class="text-blue-600 font-semibold hover:underline"
          >
            View All News →
          </a>
        </div>
      </div>
    </section>
    <script>
      // Global variable to store events data
      let events = [];

      // Fetch events from API
      async function fetchEvents() {
        try {
          const response = await fetch('/doctor-appoinment/Backend/api/events.php?action=public');
          const data = await response.json();
          
          if (data.status === 'success') {
            events = data.data;
            renderEvents();
          } else {
            console.error('Failed to fetch events:', data.message);
            // Fallback to empty state
            const newsContainer = document.getElementById("newsContainer");
            newsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No events available at the moment.</p>';
          }
        } catch (error) {
          console.error('Error fetching events:', error);
          // Fallback to empty state
          const newsContainer = document.getElementById("newsContainer");
          newsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">Unable to load events. Please try again later.</p>';
        }
      }

      // Render events on the page
      function renderEvents() {
        const newsContainer = document.getElementById("newsContainer");
        newsContainer.innerHTML = ''; // Clear existing content

        if (events.length === 0) {
          newsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No events available at the moment.</p>';
          return;
        }

        events.forEach((event) => {
          const newsCard = document.createElement("div");
          newsCard.className =
            "bg-white border border-gray-200 overflow-hidden shadow-sm hover:shadow-lg transition flex flex-col";

          // Use the image from database or fallback to default
          const eventImage = event.image_path ? `/doctor-appoinment/uploads/events/${event.image_path}` : "../public/assets/eyecare.jpg";
          const eventTitle = event.title || "Event";
          const eventDescription = event.description || "Join us for this special event.";
          const eventDate = event.event_date ? new Date(event.event_date).toLocaleDateString() : "TBA";

          newsCard.innerHTML = `
        <!-- Event Image Wrapper -->
        <div class="relative h-56 w-full overflow-hidden group">
          <img src="${eventImage}" alt="${eventTitle}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>

        <!-- Event Content -->
        <div class="p-6 flex flex-col justify-between flex-grow">
          <h3 class="text-xl font-semibold text-blue-800 mb-2 text-start">${eventTitle}</h3>
          <div class="flex items-center gap-1 mb-2">
            <i class="fa-solid fa-calendar-days text-gray-300 text-sm"></i>
            <h4 class="text-md font-semibold text-gray-300 mb-2 text-start">${eventDate}</h4>
          </div>

          <p class="text-gray-600 text-md mb-4 clamp-4 text-start leading-relaxed text-start clamp-4">${eventDescription}</p>

        </div>
        </div>
      `;

          newsContainer.appendChild(newsCard);
        });
      }

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", () => {
        fetchEvents();
      });
    </script>

    <!-- OUR PHILOSOPHY -->

    <!-- HOSPITAL DEPARTMENTS -->
    <section>
      <div class="text-center my-10 container max-w-6xl mx-auto px-4">
        <h2 class="text-3xl text-flourish-500 font-bold">
          HOSPITAL DEPARTMENTS
        </h2>

        <div class="w-40 h-0.5 bg-red-400 mt-4 mx-auto"></div>

        <!--  Cards Grid -->
        <div
          id="departmentsContainer"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mt-10"
        >
          <!-- Cards will be injected by JS -->
        </div>

        <div class="mt-8">
          <a
            href="./services.html"
            class="text-blue-600 font-semibold hover:underline"
          >
            View All Departments →
          </a>
        </div>
      </div>
    </section>
    <script>
      // Global variable to store departments data
      let departments = [];

      // Fetch departments from API
      async function fetchDepartments() {
        try {
          const response = await fetch('/doctor-appoinment/Backend/api/departments.php?action=public');
          const data = await response.json();
          
          if (data.status === 'success') {
            departments = data.data;
            renderDepartments();
          } else {
            console.error('Failed to fetch departments:', data.message);
            // Fallback to empty state
            const departmentsContainer = document.getElementById("departmentsContainer");
            departmentsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No departments available at the moment.</p>';
          }
        } catch (error) {
          console.error('Error fetching departments:', error);
          // Fallback to empty state
          const departmentsContainer = document.getElementById("departmentsContainer");
          departmentsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">Unable to load departments. Please try again later.</p>';
        }
      }

      // Render departments on the page
      function renderDepartments() {
        const departmentsContainer = document.getElementById("departmentsContainer");
        departmentsContainer.innerHTML = ''; // Clear existing content

        if (departments.length === 0) {
          departmentsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No departments available at the moment.</p>';
          return;
        }

        departments.forEach((department) => {
          const departmentCard = document.createElement("div");
          departmentCard.className =
            "bg-white border border-gray-200 overflow-hidden shadow-sm hover:shadow-lg transition flex flex-col";

          // Use the image from database or fallback to default
          const departmentImage = department.image_path ? `/doctor-appoinment/uploads/departments/${department.image_path}` : "../public/assets/nephrology.jpg";
          const departmentName = department.name || "Department";
          const departmentDescription = department.description || "Specialized medical department providing quality healthcare services.";

          departmentCard.innerHTML = `
        <!-- Department Image Wrapper -->
        <div class="relative h-56 w-full overflow-hidden group">
          <img src="${departmentImage}" alt="${departmentName}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>

        <!-- Department Content -->
        <div class="p-6 flex flex-col justify-between flex-grow">
          <h3 class="text-xl font-semibold text-blue-800 mb-2 text-start">${departmentName}</h3>
          

          <p class="text-gray-600 text-md mb-4 clamp-4 text-start leading-relaxed text-start clamp-4">${departmentDescription}</p>

        </div>
        </div>
      `;

          departmentsContainer.appendChild(departmentCard);
        });
      }

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", () => {
        fetchDepartments();
      });
    </script>

    <!-- Footer -->
    <div id="footer"></div>
    <script>
      fetch("footer.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("footer").innerHTML = data;
        });
    </script>

    <!-- Placeholder for spinner -->
    <div id="spinner"></div>

    <script>
      // Load spinner markup
      fetch("spinner.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("spinner").innerHTML = data;

          // Now spinner is in DOM -> attach JS logic
          const spinner = document.getElementById("spinner-overlay");

          function showSpinner() {
            spinner.classList.remove("hidden");
          }
          function hideSpinner() {
            spinner.classList.add("hidden");
          }

          // Show on links
          document.querySelectorAll("a").forEach((link) => {
            link.addEventListener("click", () => {
              if (
                link.getAttribute("href") !== "#" &&
                !link.getAttribute("href")?.startsWith("javascript")
              ) {
                showSpinner();
                setTimeout(hideSpinner, 10000); // works now
              }
            });
          });

          // Show on .show-spinner buttons
          document.querySelectorAll("button.show-spinner").forEach((btn) => {
            btn.addEventListener("click", () => {
              showSpinner();
              setTimeout(hideSpinner, 10000); // works now
            });
          });

          // Show on form submit
          document.querySelectorAll("form").forEach((form) => {
            form.addEventListener("submit", () => {
              showSpinner();
              setTimeout(hideSpinner, 10000); // works now
            });
          });

          // Optional: hide spinner after page load (auto)
          setTimeout(() => hideSpinner(), 10000);
        });
    </script>

    <script src="../public/js/script.js"></script>
    <script src="shared-nav.js"></script>
  </body>
</html>
